package com.s.k.starknight.config

import kotlin.text.ifEmpty
import com.google.firebase.Firebase
import com.google.firebase.remoteconfig.ConfigUpdate
import com.google.firebase.remoteconfig.ConfigUpdateListener
import com.google.firebase.remoteconfig.FirebaseRemoteConfigException
import com.google.firebase.remoteconfig.remoteConfig
import com.s.k.starknight.manager.AppUserAttr
import com.s.k.starknight.sk

class RemoteConfig {

    private val config by lazy { Firebase.remoteConfig }

//    private val serverListDefaultConfig = "ewogICAgInNob3dfbGlzdCI6IFsKICAgICAgICB7CiAgICAgICAgICAgICJuYW1lIjogIlVTLURhbGxhcy0xIiwKICAgICAgICAgICAgImNvZGUiOiAiVVMiLAogICAgICAgICAgICAiYWNjIjogWwogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2ODQtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNjg1LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDY4Ni1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2ODctc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNjg4LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDY4OS1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2OTAtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNjkxLXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDY5Mi1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2OTMtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIgogICAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgICJuYW1lIjogIlVTLURhbGxhcy0yIiwKICAgICAgICAgICAgImNvZGUiOiAiVVMiLAogICAgICAgICAgICAiYWNjIjogWwogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2OTQtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNjk1LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDY5Ni1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2OTctc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNjk4LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDY5OS1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MDAtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzAxLXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcwMi1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MDMtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIgogICAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgICJuYW1lIjogIlVTLUxvc0FuZ2VsZXMtMSIsCiAgICAgICAgICAgICJjb2RlIjogIlVTIiwKICAgICAgICAgICAgImFjYyI6IFsKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzA0LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcwNS1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MDYtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzA3LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcwOC1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MDktc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzEwLXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcxMS1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MTItc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzEzLXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIKICAgICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICAibmFtZSI6ICJVUy1Mb3NBbmdlbGVzLTIiLAogICAgICAgICAgICAiY29kZSI6ICJVUyIsCiAgICAgICAgICAgICJhY2MiOiBbCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcxNC1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MTUtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzE2LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcxNy1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MTgtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzE5LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcyMC1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MjEtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzIyLXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcyMy1zZXNzdGltZS01OjRwbXBhczZ0eXIiCiAgICAgICAgICAgIF0KICAgICAgICB9CiAgICBdCn0"
    private val serverListDefaultConfig = "aweijewogICAgInNob3dfbGlzdCI6IFsKICAgICAgICB7CiAgICAgICAgICAgICJuYW1lIjogIlVTLURhbGxhcy0xIiwKICAgICAgICAgICAgImNvZGUiOiAiVVMiLAogICAgICAgICAgICAiYWNjIjogWwogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2ODQtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNjg1LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDY4Ni1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2ODctc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNjg4LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDY4OS1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2OTAtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNjkxLXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDY5Mi1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2OTMtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIgogICAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgICJuYW1lIjogIlVTLURhbGxhcy0yIiwKICAgICAgICAgICAgImNvZGUiOiAiVVMiLAogICAgICAgICAgICAiYWNjIjogWwogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2OTQtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNjk1LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDY5Ni1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg2OTctc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNjk4LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDY5OS1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MDAtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzAxLXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcwMi1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MDMtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIgogICAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgICJuYW1lIjogIlVTLUxvc0FuZ2VsZXMtMSIsCiAgICAgICAgICAgICJjb2RlIjogIlVTIiwKICAgICAgICAgICAgImFjYyI6IFsKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzA0LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcwNS1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MDYtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzA3LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcwOC1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MDktc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzEwLXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcxMS1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MTItc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzEzLXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIKICAgICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICAibmFtZSI6ICJVUy1Mb3NBbmdlbGVzLTIiLAogICAgICAgICAgICAiY29kZSI6ICJVUyIsCiAgICAgICAgICAgICJhY2MiOiBbCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcxNC1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MTUtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzE2LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcxNy1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MTgtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzE5LXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcyMC1zZXNzdGltZS01OjRwbXBhczZ0eXIiLAogICAgICAgICAgICAgICAgIjRibjRkOHkyLm5hLnRob3JkYXRhLm5ldDo5OTk5OnRkLWN1c3RvbWVyLW94T3NGbXlwcjR0Yi1jb250aW5lbnQtbmEtY291bnRyeS11cy1zZXNzaWQtdXNnM3NieGVqZmlweGg3MjEtc2Vzc3RpbWUtNTo0cG1wYXM2dHlyIiwKICAgICAgICAgICAgICAgICI0Ym40ZDh5Mi5uYS50aG9yZGF0YS5uZXQ6OTk5OTp0ZC1jdXN0b21lci1veE9zRm15cHI0dGItY29udGluZW50LW5hLWNvdW50cnktdXMtc2Vzc2lkLXVzZzNzYnhlamZpcHhoNzIyLXNlc3N0aW1lLTU6NHBtcGFzNnR5ciIsCiAgICAgICAgICAgICAgICAiNGJuNGQ4eTIubmEudGhvcmRhdGEubmV0Ojk5OTk6dGQtY3VzdG9tZXItb3hPc0ZteXByNHRiLWNvbnRpbmVudC1uYS1jb3VudHJ5LXVzLXNlc3NpZC11c2czc2J4ZWpmaXB4aDcyMy1zZXNzdGltZS01OjRwbXBhczZ0eXIiCiAgICAgICAgICAgIF0KICAgICAgICB9CiAgICBdCn0iowen"

    fun fetchAndActivate() {
        setDefaultConfig()
        config.addOnConfigUpdateListener(object : ConfigUpdateListener {
            override fun onUpdate(configUpdate: ConfigUpdate) {
                resetData()
            }

            override fun onError(error: FirebaseRemoteConfigException) {
            }
        })
        config.fetchAndActivate().addOnCompleteListener {
            if (it.isSuccessful) {
                resetData()
            }
        }
    }

    private fun resetData() {
        sk.initFacebook()
        sk.ad.resetData()
    }

    private fun setDefaultConfig() {
        config.setDefaultsAsync(hashMapOf<String, Any>().apply {
            //TODO修改默认配置
            put(AppUserAttr.UserKey.USER_KEY1.key, AppUserAttr.UserType.VIP.type)
            put(AppUserAttr.UserKey.USER_KEY2.key, AppUserAttr.UserType.NORMAL.type)
            put("sk_ad_val_fb_mul", 1.0)
            put("sk_user_attr_limit_time", 48 * 60 * 60)
            put("sk_server_list_config", serverListDefaultConfig)
            put("sk_remain_time", 900)
//            put("sk_remain_time", 60)
            //TODO
            put("sk_interval_start", 600)
            put("sk_interval_end", 900)
//            put("sk_interval_start", 60)
//            put("sk_interval_end", 120)
            put("sk_count_down_time", 30)
        })
    }

    val userType: Int
        get() {
            return config.getLong(
                sk.preferences.firebaseUserKey.orEmpty()
                    .ifEmpty { AppUserAttr.UserKey.USER_KEY2.key }).toInt()
        }

    val facebookValueMul: Double
        get() {
            return config.getDouble("sk_ad_val_fb_mul")
        }

    val facebookValueLimit: Double
        get() {
            return config.getDouble("sk_ad_val_fb_limit")
        }

    val facebookInfoConfig: String
        get() {
            return config.getString("sk_fb_info_txt")
        }

    val userAttrChangeLimitTime: Long
        get() {
            return config.getLong("sk_user_attr_limit_time")
        }

    val adMoldConfig: String
        get() {
            //TODO 修改广告配置
            return config.getString("sk_ad_mold_txt").ifEmpty {
                "eyJza19uYXRpdmUiOnsic2tfaWRfYXJyYXkiOlt7InNrX2lkIjoiY2EtYXBwLXB1Yi04MjEwMzk5NTI5NTE1ODYzLzc3ODY2MDQyNTAiLCJza19ncmFkZSI6M30seyJza19pZCI6ImNhLWFwcC1wdWItODIxMDM5OTUyOTUxNTg2My80OTMzNjU3MzE4Iiwic2tfZ3JhZGUiOjJ9LHsic2tfaWQiOiJjYS1hcHAtcHViLTgyMTAzOTk1Mjk1MTU4NjMvMzYyMDU3NTY0NyIsInNrX2dyYWRlIjoxfV0sInNrX2NvdW50IjoyfSwic2tfaW50ZXJzdGl0aWFsIjp7InNrX2lkX2FycmF5IjpbeyJza19pZCI6ImNhLWFwcC1wdWItODIxMDM5OTUyOTUxNTg2My82MzI2MTgyOTIyIiwic2tfZ3JhZGUiOjN9LHsic2tfaWQiOiJjYS1hcHAtcHViLTgyMTAzOTk1Mjk1MTU4NjMvNTE2MDQ0MDkxOCIsInNrX2dyYWRlIjoyfSx7InNrX2lkIjoiY2EtYXBwLXB1Yi04MjEwMzk5NTI5NTE1ODYzLzM4NDczNTkyNDIiLCJza19ncmFkZSI6MX1dLCJza19jb3VudCI6Mn0sInNrX29wZW4iOnsic2tfaWRfYXJyYXkiOlt7InNrX2lkIjoiY2EtYXBwLXB1Yi04MjEwMzk5NTI5NTE1ODYzLzg4MjgyMjMxODgiLCJza19ncmFkZSI6NCwic2tfbW9sZCI6InNrX29wZW4ifSx7InNrX2lkIjoiY2EtYXBwLXB1Yi04MjEwMzk5NTI5NTE1ODYzLzM4MzMzNTYzMDgiLCJza19ncmFkZSI6Mywic2tfbW9sZCI6InNrX2ludGVyc3RpdGlhbCJ9LHsic2tfaWQiOiJjYS1hcHAtcHViLTgyMTAzOTk1Mjk1MTU4NjMvNzE5NjQxMTQ2NCIsInNrX2dyYWRlIjoyLCJza19tb2xkIjoic2tfaW50ZXJzdGl0aWFsIn0seyJza19pZCI6ImNhLWFwcC1wdWItODIxMDM5OTUyOTUxNTg2My8zNzgwMzU3NzQxIiwic2tfZ3JhZGUiOjEsInNrX21vbGQiOiJza19pbnRlcnN0aXRpYWwifV0sInNrX2NvdW50IjoxfSwic2tfcmV3YXJkZWRfaW50ZXJzdGl0aWFsIjp7InNrX2lkX2FycmF5IjpbeyJza19pZCI6ImNhLWFwcC1wdWItODIxMDM5OTUyOTUxNTg2My82MDc0OTAxNDg5Iiwic2tfZ3JhZGUiOjN9LHsic2tfaWQiOiJjYS1hcHAtcHViLTgyMTAzOTk1Mjk1MTU4NjMvMjUyMzExNjM5OSIsInNrX2dyYWRlIjoyfSx7InNrX2lkIjoiY2EtYXBwLXB1Yi04MjEwMzk5NTI5NTE1ODYzLzEwNzM4NTYyNDMiLCJza19ncmFkZSI6MX1dLCJza19jb3VudCI6Mn19"
            }
        }

    val adPosConfig: String
        get() {
            return config.getString("sk_ad_pos_txt").ifEmpty {
                "ewogICJza19vcGVuIjogMiwKICAic2tfbGFuZ19uYXQiOiAxLAoic2tfbGFuZ19pbnQiOjEsCiAgInNrX3NldHRpbmdzX25hdCI6IDEsCiAgInNrX3JldHVybl9pbnQiOiAxLAogICJza19hZGRfdGltZV9yZXdhcmQiOiAyLAogICJza19yZXN1bHRfbmF0IjogMiwKICAic2tfaG9tZV9uYXQiOiAyLAogICJza19ob21lX2ludCI6IDEsCiAgInNrX2Nvbm5lY3RlZF9pbnQiOiAxLAogICJza19kaXNjb25uZWN0X3N1Y2Nlc3NfaW50IjogMCwKInNrX3Jlc3VsdF9pbnQiOjEsCiJza19zcGVlZF90ZXN0X3Jlc3VsdF9pbnQiOjEKfQ=="
            }
        }

    // 1.0.1版本key
//    val serverConfig: String
//        get() {
//            return config.getString("sk_server_list_config").ifEmpty { serverListDefaultConfig }
//        }

    val serverConfig: String
        get() {
            return config.getString("sk_server_list_config1").ifEmpty { serverListDefaultConfig }
        }

    val remainTime : Long
        get(){
            return config.getLong("sk_remain_time")
        }

    val intervalStartTime : Long
        get() {
            return config.getLong("sk_interval_start")
        }

    val intervalEndTime : Long
        get() {
            return config.getLong("sk_interval_end")
        }

    // 倒计时还剩多少弹窗
    val countDownLeftTime: Long
        get(){
            return config.getLong("sk_count_down_time")
        }
}